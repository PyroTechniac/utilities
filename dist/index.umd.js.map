{"version":3,"file":"index.umd.js","sources":["../src/index.ts"],"sourcesContent":["const { getPromiseDetails, getProxyDetails } =\n\ttypeof process === 'undefined'\n\t\t? {\n\t\t\t\tgetPromiseDetails: () => undefined,\n\t\t\t\tgetProxyDetails: () => undefined\n\t\t  }\n\t\t: // @ts-ignore process.binding exists\n\t\t  process.binding('util');\n\n/**\n * The class for deep checking Types\n */\nexport class Type {\n\t/**\n\t * The value to generate a deep Type of\n\t */\n\tpublic readonly value: unknown;\n\n\t/**\n\t * The shallow type of this\n\t */\n\tpublic is: string;\n\n\t/**\n\t * The parent of this Type\n\t */\n\tprivate readonly parent: Type | null;\n\n\t/**\n\t * The child keys of this Type\n\t */\n\tprivate readonly childKeys = new Map<string, Type>();\n\n\t/**\n\t * The child values of this Type\n\t */\n\tprivate readonly childValues = new Map<string, Type>();\n\n\t/**\n\t * @param value The value to generate a deep Type of\n\t * @param parent The parent value used in recursion\n\t */\n\tpublic constructor(value: unknown, parent: Type | null = null) {\n\t\tthis.value = value;\n\t\tthis.is = Type.resolve(value);\n\t\tthis.parent = parent;\n\t}\n\n\t/**\n\t * The type string for the children of this Type\n\t */\n\tprivate get childTypes(): string {\n\t\tif (!this.childValues.size) return '';\n\t\treturn `<${(this.childKeys.size ? `${Type.list(this.childKeys)}, ` : '') + Type.list(this.childValues)}>`;\n\t}\n\n\t/**\n\t * The full type string generated.\n\t */\n\tpublic toString(): string {\n\t\tthis.check();\n\t\treturn `${this.is}${this.childTypes}`;\n\t}\n\n\t/**\n\t * Walks the linked list backwards, for checking circulars.\n\t */\n\tprivate *parents(): Generator<Type, void, unknown> {\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias, no-cond-assign, consistent-this\n\t\tlet current: Type | null = this;\n\t\t// eslint-disable-next-line no-cond-assign\n\t\twhile ((current = current.parent)) yield current;\n\t}\n\n\t/**\n\t * Checks if the value of this Type is a circular reference to any parent.\n\t */\n\tprivate isCircular(): boolean {\n\t\tfor (const parent of this.parents()) if (parent.value === this.value) return true;\n\t\treturn false;\n\t}\n\n\t/**\n\t * The subtype to create based on this.value's sub value.\n\t * @param value The sub value\n\t */\n\tprivate addValue(value: unknown): void {\n\t\tconst child = new Type(value, this);\n\t\tthis.childValues.set(child.is, child);\n\t}\n\n\t/**\n\t * The subtype to create based on this.value's entries.\n\t * @param entry The entry\n\t */\n\tprivate addEntry([key, value]: [string, unknown]): void {\n\t\tconst child = new Type(key, this);\n\t\tthis.childKeys.set(child.is, child);\n\t\tthis.addValue(value);\n\t}\n\n\t/**\n\t * Get the deep type name that defines the input.\n\t */\n\tprivate check(): void {\n\t\tif (Object.isFrozen(this)) return;\n\n\t\tconst promise = getPromiseDetails(this.value);\n\t\tconst proxy = getProxyDetails(this.value);\n\t\tif (typeof this.value === 'object' && this.isCircular()) {\n\t\t\tthis.is = `[Circular:${this.is}]`;\n\t\t} else if (promise && promise[0]) {\n\t\t\tthis.addValue(promise[1]);\n\t\t} else if (proxy && proxy[0]) {\n\t\t\tthis.is = 'Proxy';\n\t\t\tthis.addValue(proxy[0]);\n\t\t} else if (this.value instanceof Map) {\n\t\t\tfor (const entry of this.value) this.addEntry(entry);\n\t\t} else if (Array.isArray(this.value) || this.value instanceof Set) {\n\t\t\tfor (const value of this.value) this.addValue(value);\n\t\t} else if (this.is === 'Object') {\n\t\t\tthis.is = 'Record';\n\t\t\tfor (const entry of Object.entries(this.value as Record<PropertyKey, unknown>)) this.addEntry(entry);\n\t\t}\n\n\t\tObject.freeze(this);\n\t}\n\n\t/**\n\t * Resolves the type name that defines the input.\n\t * @param value The value to get the type name of\n\t */\n\tpublic static resolve(value: any): string {\n\t\tconst type = typeof value;\n\t\tswitch (type) {\n\t\t\tcase 'object':\n\t\t\t\treturn value === null ? 'null' : value.constructor && value.constructor.name;\n\t\t\tcase 'function':\n\t\t\t\treturn `${value.constructor.name}(${value.length}-arity)`;\n\t\t\tcase 'undefined':\n\t\t\t\treturn 'void';\n\t\t\tdefault:\n\t\t\t\treturn type;\n\t\t}\n\t}\n\n\t/**\n\t * Joins the list of child types.\n\t * @param values The values to list\n\t */\n\tprivate static list(values: Map<string, Type>): string {\n\t\treturn [...values.values()].sort().join(' | ');\n\t}\n}\n"],"names":[],"mappings":"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"}